!function(e){var t=e.module("DeferredWithMultipleUpdates",[]);t.service("DeferredWithMultipleUpdates",["$q",function(e){this.all=function(){return e.all.apply(e,arguments)},this.defer=function(){var t=e.defer(),r=t.promise,n={resolve:t.resolve,reject:t.reject,then:r.then},o=!1,a=!1,u=[],i=[];return t.resolve=function(){if(o&&!a)for(var e=0,r=u.length;r>e;e++)u[e].apply({},arguments);else o=!0,n.resolve.apply(t,arguments)},t.reject=function(){if(o)for(var e=0,r=i.length;r>e;e++)i[e].apply({},arguments);else a=!0,n.reject.apply(t,arguments)},r.then=function(e,t){var o=n.then.apply(r,arguments);return e&&u.push(e),t&&i.push(t),o},t},this.reject=function(t){return rejectCallbacks.push(t),e.reject.apply(e,arguments)},this.when=function(){return e.when.apply(e,arguments)}}])}(angular),function(){var e;e=angular.module("angular-resource-factory",["DeferredWithMultipleUpdates"]).service("jtCacheService",["DSCacheFactory","ENV","$log",function(e,t,r){var n;return new(n=function(){function e(){}return e.prototype.get=function(e){var t;if((t=localStorage.getItem(e))&&"undefined"!==t)return JSON.parse(t)},e.prototype.put=function(e,t){return localStorage.setItem(e,JSON.stringify(t))},e.prototype.getForUrl=function(e){return this.get(e)},e.prototype.shouldUpdateUrl=function(e,t){return this.get(""+e+"-etag")!==t("etag")},e.prototype.update=function(e,t,n,o){var a,u,i;null==o&&(o=!0),n=angular.copy(n);for(u in n)i=n[u],0===u.indexOf("$")&&delete n[u];return(a="function"==typeof t?t("etag"):void 0)&&this.put(""+e+"-etag",a),o&&r.debug("jtCacheService.update:",e,n),this.put(e,n)},e}())}]).service("jtNetworkConnection",["$rootScope",function(e){var t;return new(t=function(){function t(){}return t.prototype.onOnline=function(t){var r;return r=function(){return e.$applyAsync(t)},"undefined"!=typeof Offline&&null!==Offline&&Offline.on("up",r),function(){return"undefined"!=typeof Offline&&null!==Offline?Offline.off("up",r):void 0}},t}())}]).factory("jtResourceFactory",["DeferredWithMultipleUpdates","jtCacheService","$http","jtNetworkConnection","$log",function(e,t,r,n){var o;return o=function(){function o(){}return o.prototype._createApiResource=function(o){var a,u,i,l,f,c,s,p,d,g,h,y,v,$,m,j,O;return a=o.$httpParams,j=o.transformResponse,g=o.isArray,u=o.cache,i=o.cacheKey,y=o.retryIfFails,m=o.transformCacheBefore,$=o.transformCacheAfter,v=u,null==v&&(v="GET"===a.method),null==i&&(i=this._generateCacheKey(a.url,a.params)),null==y&&(y=v),null==m&&(m=angular.identity),null==$&&($=angular.identity),null==j&&(j=angular.identity),null==g&&(g=!1),p=e.defer(),s=e.defer(),h=g?[]:{},h.$promise=p.promise,h.$networkPromise=s.promise,h.$resolved=!1,h.$failed=!1,h.$loading=!0,h.$resolveWith=function(e){var t,r,n;if(h.$data)if(angular.isArray(h.$data))h.splice(0,h.length);else if(angular.isObject(h.$data)){n=h.$data;for(t in n)r=n[t],delete h[t]}return h.$data=e,d(e),p.resolve(e),s.resolve(e)},d=function(e){return angular.extend(h,e)},v&&(l=t.getForUrl(i))&&(h.$resolved=!0,h.$loading=!1,c=$(angular.copy(l)),d(c),p.resolve(c)),f=function(){return h.$networkLoading=!0,r(a).success(function(e,r,n){var o;return h.$resolved=!0,h.$failed=!1,e=j(e),v&&t.shouldUpdateUrl(i,n)?(o=m(angular.copy(e)),t.update(i,n,o),h.$resolveWith(e)):h.$resolveWith(e)}).error(function(e,t,r,n){return h.$failed=!0,p.reject({data:e,status:t,headers:r,config:n}),s.reject({data:e,status:t,headers:r,config:n})})["finally"](function(){return h.$loading=!1,h.$networkLoading=!1})},f(),h.$retry=function(){return f()},y&&(O=null,h.$networkPromise["catch"](function(){return O||(O=n.onOnline(function(){return h.$failed&&!h.$networkLoading?h.$retry():void 0}))}),h.$networkPromise.then(function(){return O?(O(),O=null):void 0})),h},o.prototype._generateCacheKey=function(e,t){var r,n;t=angular.copy(t||{}),delete t.auth_token,delete t.token;for(r in t)n=t[r],angular.isNumber(n)&&(t[r]=n.toString());return e+(_.isEmpty(t)?"":JSON.stringify(t))},o}()}])}.call(this);